<?php

/**
 * HttpResponse - HTTP response wrapper
 *
 * Provides a simple response object for HTTP requests, mimicking curl_getinfo behavior
 *
 * @package   OpenEMR
 * @link      https://www.open-emr.org
 * @author    GitHub Copilot <copilot@github.com>
 * @copyright Copyright (c) 2025 GitHub Copilot
 * @license   https://github.com/openemr/openemr/blob/master/LICENSE GNU General Public License 3
 *
 * Code generated by GitHub Copilot AI
 */

namespace OpenEMR\Common\Http;

/**
 * HTTP response wrapper
 *
 * Simple data class to hold HTTP response information
 */
class HttpResponse
{
    /**
     * Constructor
     *
     * @param int $statusCode HTTP status code
     * @param string $body Response body
     * @param array $headers Response headers
     * @param string|null $error Error message if any
     */
    public function __construct(
        private readonly int $statusCode,
        private readonly string $body,
        private readonly array $headers = [],
        private readonly ?string $error = null
    ) {
    }

    /**
     * Get HTTP status code
     *
     * @return int
     */
    public function getStatusCode(): int
    {
        return $this->statusCode;
    }

    /**
     * Get response body
     *
     * @return string
     */
    public function getBody(): string
    {
        return $this->body;
    }

    /**
     * Get response headers
     *
     * @return array
     */
    public function getHeaders(): array
    {
        return $this->headers;
    }

    /**
     * Get error message
     *
     * @return string|null
     */
    public function getError(): ?string
    {
        return $this->error;
    }

    /**
     * Check if request was successful
     *
     * @return bool
     */
    public function isSuccess(): bool
    {
        return $this->statusCode >= 200 && $this->statusCode < 300 && $this->error === null;
    }

    /**
     * Check if there was an error
     *
     * @return bool
     */
    public function hasError(): bool
    {
        return $this->error !== null || $this->statusCode === 0;
    }
}
