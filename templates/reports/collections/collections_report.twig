{% extends "reports/collections/base.html.twig" %}

{% block content %}
<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <h1 class="mt-3">
                {{ 'Report'|xlt }} - {{ 'Collections'|xlt }}
                <button type="button" class="btn btn-link" data-toggle="modal" data-target="#helpModal">
                    <i class="fa fa-question-circle" aria-hidden="true"></i>
                    <span class="sr-only">{{ 'Help'|xlt }}</span>
                </button>
            </h1>
        </div>
    </div>

    {# Filters and Parameters Form #}
    {% include 'reports/collections/_filters_form.twig' %}

    {# Results Table (shown after form submission) #}
    {% if show_results %}
        {% include 'reports/collections/_results_table.twig' %}

        {# Action Buttons (for exports and bulk operations) #}
        {% include 'reports/collections/_action_buttons.twig' %}
    {% endif %}
</div>

{# Help Modal #}
<div class="modal fade" id="helpModal" tabindex="-1" role="dialog" aria-labelledby="helpModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="helpModalLabel">{{ 'Collections Report Help'|xlt }}</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="{{ 'Close'|xlt }}">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <h6>{{ 'Report Categories'|xlt }}</h6>
                <ul>
                    <li><strong>{{ 'Open'|xlt }}:</strong> {{ 'All invoices with unpaid balances'|xlt }}</li>
                    <li><strong>{{ 'Due Pt'|xlt }}:</strong> {{ 'Invoices where patient payment is due'|xlt }}</li>
                    <li><strong>{{ 'Due Ins'|xlt }}:</strong> {{ 'Invoices awaiting insurance payment'|xlt }}</li>
                    <li><strong>{{ 'Ins Summary'|xlt }}:</strong> {{ 'Summary grouped by insurance company'|xlt }}</li>
                    <li><strong>{{ 'Credits'|xlt }}:</strong> {{ 'Invoices with credit balances'|xlt }}</li>
                    <li><strong>{{ 'All'|xlt }}:</strong> {{ 'All invoices regardless of balance'|xlt }}</li>
                </ul>

                <h6 class="mt-3">{{ 'Age By Options'|xlt }}</h6>
                <ul>
                    <li><strong>{{ 'Service Date'|xlt }}:</strong> {{ 'Calculate aging from the date of service'|xlt }}</li>
                    <li><strong>{{ 'Last Activity Date'|xlt }}:</strong> {{ 'Calculate aging from the most recent payment, adjustment, or statement date'|xlt }}</li>
                </ul>

                <h6 class="mt-3">{{ 'Aging Columns'|xlt }}</h6>
                <p>{{ 'Configure the number of aging buckets and the days per bucket. For example, 3 columns with 30 days each creates buckets: 0-29, 30-59, 60+'|xlt }}</p>

                <h6 class="mt-3">{{ 'Displayed Columns'|xlt }}</h6>
                <p>{{ 'Check the boxes to show or hide specific patient information columns in the report'|xlt }}</p>

                <h6 class="mt-3">{{ 'Export Options'|xlt }}</h6>
                <ul>
                    <li><strong>{{ 'Export CSV'|xlt }}:</strong> {{ 'Download selected invoices as a CSV file'|xlt }}</li>
                    <li><strong>{{ 'Export to Collections'|xlt }}:</strong> {{ 'Export in fixed-length format for collection agencies and mark as in collections'|xlt }}</li>
                    <li><strong>{{ 'Clear Insurance Debt'|xlt }}:</strong> {{ 'Post adjustments to clear insurance balances for selected invoices'|xlt }}</li>
                    <li><strong>{{ 'Export Zero Balances'|xlt }}:</strong> {{ 'Include invoices with zero balance in export'|xlt }}</li>
                    <li><strong>{{ 'Export Individual Invoices'|xlt }}:</strong> {{ 'Export by individual invoice instead of grouping by patient'|xlt }}</li>
                    <li><strong>{{ 'Without Update'|xlt }}:</strong> {{ 'Export without marking invoices as in collections'|xlt }}</li>
                </ul>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">{{ 'Close'|xlt }}</button>
            </div>
        </div>
    </div><!---help--->
</div>
{% endblock %}

{% block scripts %}
    {{ parent() }}
{% endblock %}
